---
index: 2
icon: creative
title: nat와 포트포워딩
category:
  - Network
tag:
  - 네트워크
editLink: false
---

:::tip

:::

## NAT

- nat란?
  NAT(Network Address Translation)은 IP 패킷의 TCP/UDP 포트 숫자와
  소스 및 목적지의 IP 주소 등을 재기록하면서 라우터를 통해 네트워크
  트래픽을 주고 받는 기술을 말한다.

패킷에 변화가 생기기 때문에 IP나 TCP/UDP의 체크섬(checksum)도 다시
계산되어 재기록해야 한다.
NAT를 이용하는 이유는 대개 사설 네트워크에 속한 여러 개의 호스트가
하나의 공인 IP 주소를 사용하여 인터넷에 접속하기 위함이다.
하지만 꼭 사설IP를 공인IP로 변환 하는 데에만 사용하는 기술은 아니다.

특정 ip포트의 특정 port번호로 가는 패킷을 다른 ip의 다른 port번호로 바꿔주는 기술 이 기술 이용해서 일반적으로
사설IP를 공인IP로 변환 하는 데사용하지만 , 꼭 그거에만 쓰지는 않는다.
단순히 기술인거다.

공유기 안에 nat 테이블 안에 통신한 ip기록을 남긴다.

## 포트포워딩

nat를 응용한 기술이다.
일반적으로 서버가 사설네트워크 대역에 있을때 그 네트워크 대역을 설정하는 3계층 장비에서 제공

패킷을 보낼때 공인 IP(목적지)의 특정 포트로 통신을 보내면,
받는 쪽에서 설정을 해놔야 한다.

특정 포트로 들어온 요청을
다른 특정 IP의 특정 포트로 전송한다.

포트 포워딩 또는 포트 매핑(port mapping)은 패킷이 라우터나 방화벽과
같은 네트워크 장비를 가로지르는 동안 특정 IP 주소와 포트 번호의
통신 요청을 특정 다른 IP와 포트 번호로 넘겨주는 네트워크 주소 변환(NAT)
의 응용이다.
이 기법은 게이트웨이(외부망)의 반대쪽에 위치한 사설네트워크에 상주하는
호스트에 대한 서비스를 생성하기 위해 흔히 사용된다.

## 실습

1. 포트포워딩 설정해보기
   포트포워딩을 이용하여 다른 사용자들이 사설IP를 사용하는
   서버로 접속 할 수 있도록 설정해보기
1. 게이트웨이 ip를 웹브라우저로 입력
   http://192.168.0.1/
   id, pw 입력. 설정 전에라면 일반적으로 공유기에 적혀있다.
   (사진)
1. setup 에 들어가서
   Advanced Setup - > NAT/Routing -> Port Forwarding
   (사진)
1. 규칙이름 : 아무거나
   내부IP : 공인 IP로 들어 왔을 때 전송해줄 ip
   외부 포트 : 사용자가 사용하는 포트
   내부 포트 : 서버의 포트

- 포트번호 하나로 열꺼라면 80 - 80
  실습-5 사진

사용자가 공인IP:80 으로 들어오면
포트포워딩 통해서 192.168.0.36:8080으로 전송해준다.

2. 사설 IP를 사용하는 서버로 접속해보기
   사설IP를 사용하는 가상머신에 서버를 설정하고 해당 서버를 포트포워딩을 통해 접속할 수
   있도록 설정해보기
