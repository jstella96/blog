---
order: 8
icon: creative
title: 병행 프로세스와 상호배제
category:
  - OS
tag:
  - 운영체제
editLink: false
---

::: tip GOAL
Q. 병행프로세스란 무엇인가요?
Q. 뮤텍스와 세마포어란 무엇이고 둘의 차이점은 무엇인가요?
:::
해당페이지는 2022년 3월 노션에서 마이그레이션 되었습니다.

## 병행프로세스

- 병행프로세스란 여러 프로세스를 동시에 실행하는 것처럼 보이는 것을 병행 프로세스라고 한다.  
  독립 프로세스 : 단일 처리 시스템에서 서로 독립적으로 작업을 수행하는 병행프로세스  
  협력 프로세스 : 다른 프로세스에 영향을 주고 받으며 즉 상호작용하며 특정기능을 수행하는 비동기적 프로세스 이다.  
  :::info 병행성과 병렬성
  병행성과 병렬성은 둘 다 대략적으로 '동일한 시간동안 여러 프로세스를 동시 실행' 이라는 의미를 담고 있다.
  하지만 둘은 전혀 다르다. 먼저 병렬성을 기반으로 한 병렬 컴퓨팅은 다중 프로세서(CPU) 시스템에서 동일한 시간에 별도의 프로세서(CPU)에서 실행하는 것이다. 반면에 병행성을 기반으로한 동시 컴퓨팅은 프로세스 수명이 겹치는 것이지 모두 동일한
  시간에 실행할 필요는 없다. 예를 들어 , 병행 프로세스는 시분할로 각 프로세스의 실행단계를 전환하여 어느 한 순간에는 프로세스 하나를 실행하도록 하는 방법으로 단일 프로세서(CPU) 시스템에서도 가능하다.
  :::
- 병행 프로세스 해결과제
  시스템의 신뢰도를 높이기 위해서는 공유자원을 상호 배타적으로 사용해야한다. 어떤 프로세스가 작업을 실행 중일 떄 나머지 프로세스는 그 작업에 관련되 작업을 수행할 수 없도록 상호배제와 동기화를 해야한다. 프로세스는 동시에 수행하는 다른 프로세스의 실행속도와 관계없이 항상 일정한 실행 결과를 보장하도록 결정성을 확보해야한다. 특히 교착상태를 해결하고 병행 프로세스들의 병렬처리 능력을 극대화시켜야 한다

## 상호배제와 동기화

상호배제 : 병행 프로세스에서 프로세스 하나가 공유자원을 사용할 때 다른 프로세스가 해당 데이터에 접근 할 수 없게 하는 것  
동기화 : 공유 자원을 동시에 사용하지 못하게 실행을 제어하는 방법 \*경쟁상태(race condition) : 여러프로세스가 동시에 공유데이터에 접근할 떄 접근 순서에 따라 실행결과가 달라지는 상황이다.

### 발생할 수 있는 임계구역 문제와 해결안은?

- 임계구역(critical section) :
  - 각 프로세스에 있는, 다른 프로세스들과 공유하는 변수를 변경, 데이터 갱신, 파일쓰기 등의 작업을 하는 코드 부분이다.
  - 프로그램 코드 상에서 공유 자원에 접근하는 부분을 임계 구역이라 한다.
  - 멀티프로세스가 나오면서 데이터를 어느 프로세스가 조작하고 있는데 중간에 다른 프로세스가 끼어들어서 데이터를 조작하면 의도하지 못한 결과를 가져올 수있다 (임계구역에서 동시작업이 가능하다면)
- 한 순간에 하나의 프로세스만 임계구역을 컨트롤 할 수 있도록 제어한다.
  (e.counter 사용)
- 임계구역 해결안의 요구사항 ⇒ 상호배제 요건, 진행, 제한이 있는 대기시간
- 피터슨의 해결안 : 두개의 프로세스가 두개의 데이터 항목 턴 플래그배열이용해서 임계구역 으로 진입할수있는지 여부 판별

- 뮤텍스와 세마포어의 개념을 이해한다.

  - 뮤텍스 : 상호배제를 가능하도록 하는 락(lock) / 뮤텍스락
    - 임계 구역을 보호
    - 하나의 데이터에 프로세스들이 동시에 경쟁하지 않도록 해준다.
  - 세마포어
    - 정수 변수 S(카운터 변수)
    - 뮤텍스와 다르게 1보다 큰 정수 사용 가능, 접근가능한 프로세스 개수를 통제 가능
    - wait / signal 연산을 수행하여 동기화 문제를 해결

  ⇒ 둘 다 busy waiting 단점 존재한다  
  => 뮤텍스(Mutex)와 세마포어의 차이점

  - 뮤텍스는 오직 1개의 프로세스 혹은 스레드만이 공유 자원에 접근할 수 있고, 세마포어는 지정된 변수의 값만큼 접근할 수 있다.
  - 세마포어는 운영체제 혹은 커널 단위에서 해당 리소스 변수가 관리되어 현재 공유 자원을 사용 중인 대상 뿐만아니라 다른 프로세스 및 스레드도 잠금 상태를 해제할 수 있지만 뮤텍스는 프로세스 단에서 관리되고 해당 변수(Lock)을 가지고 있기 때문에 Lock을 가지고 있는 변수만이 Unlock을 할 수 있다.

## 상호배제 방법

- 데커의 알고리즘: 병행 프로그래밍의 상호배제를 풀 수 있는 첫번째 해결책으로, 두 프로세스가 서로 통신하려고 공유 메모리를 사용하여 충돌 없이 단일 자원을 공유 할 수 있도록 허용한다.
- TestAndSet(TAS,테스) 명령어 : 소프트웨어적인 해결책은 더 복잡하고, 프로세스가 2개 이상일때는 더 많이 대기 할 수 있다. 이때 기계를 비교하거나 단어 내요ㅕㅇ을 검사.수정하는 특별한 하드웨어 명령어 TestAndSet을 사용하여 간단한 방법으로 임계영역 문제를 해결할 수 있다
- 세마포: 상호배제 해결책에는 바쁜 대기로 프로세스를 낭비한다는 단점이 있다. 다익스트라가 진입조건을 반복 조사하지 않고 true 일때 프로세스상태를 확인하는 새로운 동기화 도구인 세마포를 제안하여 이문제를 해결했다. 세마포는 상호배제에 사용할뿐만 아니라 다양한 연산의 순서도 제공한다.
- 모니터 : 세마포를 잘못 사용하면 여러가지 오류가 쉽게 발생하여 프로그램을 작성하기가 어렵다. 이런 단점을 극복하려고 모니터가 등장했다.
  모니터는 공유자원과 이것의 임계영역을 관리하는 소프트웨어 구성체이다. 다시말해 자원에 배타적으로 접근할 수 있도록 프로세스가 사용하는 병행 프로그래밍 구조이다.

### 여러 전통적인 프로세스 동기화 문제

- 생산자.소비자 문제 : 운영체제에서 비동기적으로 수행하는 모델로, 생산자 프로세스가 생산한 정보를 소비자 프로세스가 소비하는 형태이다. 생산자와 소비자가 불필요하게 공회전하지 않도록 생산자와 소비자를 동기화 해야한다.
- 유한 버퍼 문제
- Readers, Writers 문제
- 식사하는 철하자는 문제
